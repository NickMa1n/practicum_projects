## Выпускной проект
`pandas, numpy, matplotlib, phik, shap, seaborn, sklearn, catboost`
### Телекоммуникации
### Описание проекта
Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах.    
**Цель проекта:** создать модель для прогноза оттока клиентов (задача классификации).    

*Описание услуг*

Оператор предоставляет два основных типа услуг: 
* Стационарную телефонную связь. Телефон можно подключить к нескольким линиям одновременно.
* Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line — «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).  

Также доступны такие услуги:
* Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
* Выделенная линия технической поддержки (TechSupport);
* Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
* Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).  

Клиенты могут платить за услуги каждый месяц или заключить договор на 1–2 года. Возможно оплатить счёт разными способами, а также получить электронный чек.    

*План работы*

    Шаг 1. Загрузка данных, базовый осмотр данных, подготовка данных для работы
    Шаг 2. Объединение данных и предобработка объединённого датафрейма
    Шаг 3. Исследовательский и корреляционный анализ данных
    Шаг 4. Подготовка данных для обучения моделей
    Шаг 5. Обучение моделей машинного обучения
    Шаг 6. Выбор лучшей модели. Анализ признаков, матрица ошибок
    Шаг 7. Общий вывод и рекомендации заказчику
### Общий вывод
В данной выпускной работе для оператора связи «ТелеДом» была создана модель для прогноза оттока клиентов. Вся работа была поделена на этапы:  
1. На этапе загрузки данных были импортированы необходимые библиотеки, проведен первичный осмотр данных. Обработаны пустые строки в ``contract_df``, приведен к соответствующему типу данных столбец 'SeniorCitizen' в ``personal_df``.    
2. На следующем подготовительном этапе объединили все таблицы в одну ``all_df``. Обработали пропущенные значения в полученном объединенном датафрейме. Создали новый признак - срок договора в днях. Извлекли из столбца 'EndDate' целевой признак 'status'.    
3. На этапе исследовательского анализа построены соответствующие графики распределения для количественных, категориальных и целевого признаков. Признак 'MonthlyCharges' имеет пик при маленьких расходах, далее график напоминает нормальное распределение. График признака 'TotalCharges' имеет вид распределения Пуассона, на диаграмме размаха отмечаются выбросы. Признак 'contract_term' на графике распределения имеет два пика вначале (100-200 дней) и в конце (более 2000 дней).    
Для категориальных признаков выделены следующие наблюдения:
    * более половины пользователей оплачивают услуги помесячно;
    * дисбаланс классов у признака 'SeniorCitizen', остальные признаки распределены без сильного перекоса в какую-либо сторону.
    Также есть дисбаланс у целевого признака 'status' (84.4/15.6), в работе будем использовать метрику roc-auc для оценки качества модели, она не чувствительна к дисбалансу.    
    Провели корреляционный анализ данных, где выявили высокую коллинеарность между всеми интернет услугами и признаком месячная оплата. Чтобы убрать эту связь заменили все признаки интеренет услуг на один признак 'count_services' - кол-во подключенных услуг. В итоговой таблице получили 12 входных признаков и целевой.     
4. На этапе подготовки данных для обучения провели разделение выборки на тренировочную и тестовую. Создали итоговый пайплайн с предобработкой и обучением. Предобработка включает в себя пайплайн для кодирования входных признаков.    
5. На этапе обучения подобрали гиперпараметры для трех моделей и с помощью рандомизированного поиска по параметрам на кросс-валидации отобрали лучшую модель по метрике roc-auc. Ей оказалсь модель градиентного бустинга CatBoostClassifier. Реузальтат на тестовой выборке 0.865, что выше целевого. Дополнительно была посчитана метрика accuracy - 0.878. Модель правильно классифицировала 87.8% всех примеров в тестовой выборке, в комбинации со значением roc-auc можно смело сказать, что модель хорошо справляется со своей задачей. Для сравнения были посчитаны эти же метрики моделью, игнорирующей входные признаки. Результаты roc-auc = 0.5, accuracy = 0.844. При достаточно высоком значении accuracy значение roc-auc говорит нам, что сравниваемая модель не обладает никаким прогностическим потенциалом.    
6. На этапе анализа модели были найдены наиболее значимые признаки для модели: длительность договора, тип оплаты, общие затраты. Малозначимые признаки: является ли абонент пенсионером, пол, электронный расчетный лист, есть ли у абонента дети. Проведен анализ матрицы ошибок. Следует оценивать качество модели метрикой recall, а более точная настройка порога классификации позволит лучше определять случаи расторжений.

Рекомендации для бизнеса:
* обратить внимание на длительность договора, чем больший срок договора, тем вероятнее, что абонент его не расторгнет;
* составлять договор с оплатой раз в 2 года;
* стоит рассмотреть дополнительно метрику recall для оценки качества модели
