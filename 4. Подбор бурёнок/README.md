## Проект: Линейные модели в машинном обучении
`pandas, numpy, matplotlib, scipy, seaborn, sklearn`
### Описание проекта
Владелец молочного хозяйства хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ. Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства.
Цель: разработать модель машинного обучения, которая поможет фермеру управлять рисками и принимать объективное решение о покупке коров на основе данных фермера и данных ассоциации пастбищ, где будут приобретаться коровы  
Задачи: создать две прогнозные модели для отбора бурёнок в поголовье
1. Прогноз возможного удоя коровы (целевой признак Удой)
2. Рассчет вероятности получить вкусное молоко от коровы (целевой признак Вкус молока)  

С помощью модели нужно отобрать коров по двум критериям:
* средний удой за год — не менее 6000 килограммов;
* молоко должно быть вкусным

### Общий вывод
В данном проекте были разработаны 4 модели МО, из них 3 линейной регрессии, и 1 - логистической. В задаче про удой коровы была выбрана, на основе метрик, наиболее точная модель из 3 и по ней спрогнозированы значения удоя коров, предложенных фермеру к покупке. В задаче логистической регрессии был спрогнозирован вкус молока по имеющимся данным фермера. Следующие коровы рекомендованы к покупке:
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>breed</th>
      <th>grazing</th>
      <th>dads_breed</th>
      <th>dads_name</th>
      <th>fats</th>
      <th>proteins</th>
      <th>age</th>
      <th>pred_milk_yield</th>
      <th>pred_milk_taste</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Вис Бик Айдиал</td>
      <td>холмистое</td>
      <td>Айдиал</td>
      <td>Геркулес</td>
      <td>3.58</td>
      <td>3.076</td>
      <td>более_2_лет</td>
      <td>6609.919297</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Вис Бик Айдиал</td>
      <td>равнинное</td>
      <td>Соверин</td>
      <td>Буйный</td>
      <td>3.54</td>
      <td>3.081</td>
      <td>менее_2_лет</td>
      <td>6378.711028</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Вис Бик Айдиал</td>
      <td>равнинное</td>
      <td>Соверин</td>
      <td>Буйный</td>
      <td>3.57</td>
      <td>3.079</td>
      <td>более_2_лет</td>
      <td>6571.259737</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>РефлешнСоверинг</td>
      <td>холмистое</td>
      <td>Айдиал</td>
      <td>Буйный</td>
      <td>3.40</td>
      <td>3.079</td>
      <td>менее_2_лет</td>
      <td>6400.540668</td>
      <td>True</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Вис Бик Айдиал</td>
      <td>холмистое</td>
      <td>Соверин</td>
      <td>Барин</td>
      <td>3.42</td>
      <td>3.075</td>
      <td>менее_2_лет</td>
      <td>6127.474742</td>
      <td>True</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Вис Бик Айдиал</td>
      <td>холмистое</td>
      <td>Соверин</td>
      <td>Соловчик</td>
      <td>3.73</td>
      <td>3.079</td>
      <td>более_2_лет</td>
      <td>6344.707860</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

На этапе загрузки и предобработки данных:
* найдены 5 строк-дубликатов
* названия столбцов приведены к единому виду (зря я их на аглийский переводил, только сложности добавило)
* преобразованы типы данных в числовых столбцах в датасетах основном и с покупкой
* найдены и устранены неявные дубликаты в столбцах с типом пастбища и породы папы - устранены
* удалены дубликаты в датафрейме с коровами на продажу

На этапе исследовательского анализа:
* убрали аномальное значение в признаке удой
* большинство количественных признаков распределено нормально (жирность, СПО, сырой протеин - исключения)
* распределение категориальных признаков близко к 1:1, выделяется только признак возраст, где значение более 2 лет имеет значительный перевес в выборке

На этапе корреляционного анализа:
* отмечена высокая сила связи у целевого признака с входными признаками ЭКЕ (0,77) И СПО (0,79), но диаграмма рассеяния удой-СПО выглядит нелинейно
* отсутствует корреляция у целевого признака (удой) с признаком белка в молоке
* породы Соверинг жирность молока выше, чем у породы Айдиал, а содержание белка наоборот, в остальных признаках породы распределены равномерно
* корова с породой папы Айдиал дает в среднем молока больше, нежели породы Соверин
* корова возрастом более 2 лет дает молока больше, чем корова возрастом менее 2 лет
* пасущиеся на холмистых ландшафтах коровы в лидерах по максимальному кол-ву удоя в год
* коров возрастом менее 2 лет кормят С-П отношением менее 0,91
* Мультиколлинеарности между входными признаками не наблюдаем

На этапе решения линейной регресии:
* обучены 3 модели, оценены их метрики, проанализированы их остатки
* выбрана лучшая модель - ей оказалась модель №3, где совершили все преобразования нелинейных зависимостей и добавили еще один категориальный признак. Ее метрики:
    * MSE - 35673.889886
    * RSME - 188.875329
    * MAE - 146.163024
    * 95% доверительный интервал - (6092.340075854288, 6221.3750700583805)
* для улучшения регрессионнной модели можно увеличить выборку или добавить новые входные признаки, которые могут влиять на целевой
* получили прогноз удоя предложенных коров. Все коровы из списка удовлетворяют требованию не менее 6000 кг удоя в год

На этапе решения логистической регрессии:
* обучили и доработали модель предсказания вкуса молока
* для данной задачи важна метрика precision, так как фермеру, в первую очередь, важно чтобы молоко было вкусным
* удалось уменьшить ошибку перовго рода с 48 до 10, подобрав оптимальный порог принадлежности, однако точность модели все равно осталась на достаточно низком уровне из-за нехватки входящих признаков
* спрогнозировали вкусное молоко у 6 коров
